<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GhostBusters ‚Äî AML Mule Detection Dashboard</title>
    <meta name="description" content="Cross-Channel Mule Account Detection using GNN Real-Time Scoring">
    <link rel="stylesheet" href="/static/css/style.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <script src="https://d3js.org/d3.v7.min.js"></script>
</head>
<body>

<!-- Mobile menu toggle -->
<button class="mobile-menu-btn" onclick="document.querySelector('.sidebar').classList.toggle('open')">‚ò∞</button>

<div class="app-container">
    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê SIDEBAR ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <aside class="sidebar">
        <div class="sidebar-header">
            <div class="sidebar-logo">
                <div class="logo-icon">üëª</div>
                <div>
                    <h1>GhostBusters</h1>
                    <p>AML Detection Suite</p>
                </div>
            </div>
        </div>
        <nav class="sidebar-nav">
            <div class="nav-item active" data-page="dashboard" onclick="navigateTo('dashboard')">
                <span class="nav-icon">üìä</span>
                <span>Command Center</span>
            </div>
            <div class="nav-item" data-page="alerts" onclick="navigateTo('alerts')">
                <span class="nav-icon">üö®</span>
                <span>Alert Queue</span>
                <span class="nav-badge" id="alert-count">0</span>
            </div>
            <div class="nav-item" data-page="investigate" onclick="navigateTo('investigate')">
                <span class="nav-icon">üîç</span>
                <span>Investigation</span>
            </div>
            <div class="nav-item" data-page="models" onclick="navigateTo('models')">
                <span class="nav-icon">üß†</span>
                <span>Model Analytics</span>
            </div>
            <div class="nav-item" data-page="streaming" onclick="navigateTo('streaming')">
                <span class="nav-icon">‚ö°</span>
                <span>Streaming Demo</span>
            </div>
        </nav>
        <div class="sidebar-footer">
            <span class="status-dot"></span> System Online<br>
            <span style="margin-left: 14px; opacity: 0.6">v2.0 ‚Äî GNN Scoring Engine</span>
        </div>
    </aside>

    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê MAIN ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <main class="main-content">

        <!-- ‚îÄ‚îÄ‚îÄ PAGE: Command Center ‚îÄ‚îÄ‚îÄ -->
        <div class="page active" id="page-dashboard">
            <div class="page-header">
                <h2>Command Center</h2>
                <p>Real-time overview of the AML detection pipeline</p>
            </div>

            <div class="kpi-grid" id="kpi-grid">
                <div class="kpi-card cyan">
                    <div class="kpi-icon">üè¶</div>
                    <div class="kpi-value" id="kpi-accounts">‚Äî</div>
                    <div class="kpi-label">Total Accounts</div>
                </div>
                <div class="kpi-card red">
                    <div class="kpi-icon">‚ö†Ô∏è</div>
                    <div class="kpi-value" id="kpi-sar">‚Äî</div>
                    <div class="kpi-label">SAR Accounts</div>
                </div>
                <div class="kpi-card amber">
                    <div class="kpi-icon">üö©</div>
                    <div class="kpi-value" id="kpi-flagged">‚Äî</div>
                    <div class="kpi-label">Flagged for Review</div>
                </div>
                <div class="kpi-card green">
                    <div class="kpi-icon">üèÜ</div>
                    <div class="kpi-value" id="kpi-best-prauc">‚Äî</div>
                    <div class="kpi-label">Best PR-AUC (<span id="kpi-best-model">‚Äî</span>)</div>
                </div>
                <div class="kpi-card purple">
                    <div class="kpi-icon">üîó</div>
                    <div class="kpi-value" id="kpi-edges">‚Äî</div>
                    <div class="kpi-label">Entity Graph Edges</div>
                </div>
            </div>

            <div class="grid-2-1">
                <div class="card">
                    <div class="card-header">
                        <h3>üì° Channel Activity (Edge Types)</h3>
                    </div>
                    <div class="chart-container">
                        <canvas id="chart-channels"></canvas>
                    </div>
                </div>
                <div class="card">
                    <div class="card-header">
                        <h3>üéØ Risk Distribution</h3>
                    </div>
                    <div class="chart-container">
                        <canvas id="chart-risk"></canvas>
                    </div>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <h3>üì° Live Transaction Feed</h3>
                    <button class="btn btn-outline" id="btn-toggle-feed" onclick="toggleFeed()">‚ñ∂ Start Feed</button>
                </div>
                <div class="live-feed" id="live-feed">
                    <div class="empty-state">
                        <div class="empty-icon">üì°</div>
                        <p>Click "Start Feed" to begin streaming transactions</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- ‚îÄ‚îÄ‚îÄ PAGE: Alert Queue ‚îÄ‚îÄ‚îÄ -->
        <div class="page" id="page-alerts">
            <div class="page-header">
                <h2>Alert Queue</h2>
                <p>Flagged accounts requiring investigation</p>
            </div>

            <div class="search-bar">
                <input type="text" class="search-input" id="alert-search" placeholder="Search by Account ID or reason code..." oninput="filterAlerts()">
                <select class="filter-select" id="alert-filter" onchange="filterAlerts()">
                    <option value="all">All Risk Levels</option>
                    <option value="HIGH">High Risk</option>
                    <option value="MEDIUM">Medium Risk</option>
                    <option value="LOW">Low Risk</option>
                </select>
            </div>

            <div class="card" style="padding: 0; overflow: hidden;">
                <div style="overflow-x: auto;">
                    <table class="data-table" id="alerts-table">
                        <thead>
                            <tr>
                                <th>Account ID</th>
                                <th>Status</th>
                                <th>Risk Level</th>
                                <th>Reason Codes</th>
                                <th>Sent / Received</th>
                                <th>Fan-in Ratio</th>
                                <th>Channels</th>
                                <th></th>
                            </tr>
                        </thead>
                        <tbody id="alerts-tbody">
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- ‚îÄ‚îÄ‚îÄ PAGE: Investigation ‚îÄ‚îÄ‚îÄ -->
        <div class="page" id="page-investigate">
            <a class="back-btn" onclick="navigateTo('alerts')">‚Üê Back to Alert Queue</a>

            <div id="investigate-content">
                <div class="empty-state">
                    <div class="empty-icon">üîç</div>
                    <p>Select an account from the Alert Queue to investigate</p>
                </div>
            </div>
        </div>

        <!-- ‚îÄ‚îÄ‚îÄ PAGE: Model Analytics ‚îÄ‚îÄ‚îÄ -->
        <div class="page" id="page-models">
            <div class="page-header">
                <h2>Model Analytics</h2>
                <p>Performance comparison across 9 models (4 Baselines + 5 GNNs)</p>
            </div>

            <div class="card" style="margin-bottom: 28px;">
                <div class="card-header">
                    <h3>üìä PR-AUC Comparison</h3>
                </div>
                <div id="prauc-bars"></div>
            </div>

            <div class="grid-2">
                <div class="card">
                    <div class="card-header">
                        <h3>üìà Training Curves ‚Äî PR-AUC</h3>
                    </div>
                    <div class="chart-container">
                        <canvas id="chart-train-prauc"></canvas>
                    </div>
                </div>
                <div class="card">
                    <div class="card-header">
                        <h3>üìâ Training Curves ‚Äî Loss</h3>
                    </div>
                    <div class="chart-container">
                        <canvas id="chart-train-loss"></canvas>
                    </div>
                </div>
            </div>

            <div class="card" style="margin-bottom: 28px;">
                <div class="card-header">
                    <h3>üìã Full Metrics Table</h3>
                </div>
                <div style="overflow-x: auto;">
                    <table class="data-table" id="model-metrics-table">
                        <thead>
                            <tr>
                                <th>Model</th>
                                <th>Type</th>
                                <th>PR-AUC</th>
                                <th>ROC-AUC</th>
                                <th>F1 (SAR)</th>
                                <th>Precision</th>
                                <th>Recall</th>
                                <th>Recall@1√ó</th>
                                <th>Accuracy</th>
                            </tr>
                        </thead>
                        <tbody id="model-metrics-tbody"></tbody>
                    </table>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <h3>üîß Training Configuration</h3>
                </div>
                <div class="feature-grid" id="training-config-grid"></div>
            </div>
        </div>

        <!-- ‚îÄ‚îÄ‚îÄ PAGE: Streaming Demo ‚îÄ‚îÄ‚îÄ -->
        <div class="page" id="page-streaming">
            <div class="page-header">
                <h2>Streaming Transaction Scoring</h2>
                <p>Real-time GNN-based suspicious activity detection</p>
            </div>

            <div class="stream-stats">
                <div class="stream-stat">
                    <div class="stat-value" id="stream-total">0</div>
                    <div class="stat-label">Transactions Processed</div>
                </div>
                <div class="stream-stat">
                    <div class="stat-value" id="stream-flagged" style="color: var(--accent-red)">0</div>
                    <div class="stat-label">Flagged</div>
                </div>
                <div class="stream-stat">
                    <div class="stat-value" id="stream-avg-score">0.00</div>
                    <div class="stat-label">Avg Risk Score</div>
                </div>
                <div class="stream-stat">
                    <div class="stat-value" id="stream-rate" style="color: var(--accent-green)">0</div>
                    <div class="stat-label">TXN / sec</div>
                </div>
            </div>

            <div class="grid-2-1">
                <div class="card">
                    <div class="card-header">
                        <h3>üìä Risk Score Distribution (Live)</h3>
                    </div>
                    <div class="chart-container">
                        <canvas id="chart-stream-hist"></canvas>
                    </div>
                </div>
                <div class="card">
                    <div class="card-header">
                        <h3>üéØ Latest Scored Transaction</h3>
                    </div>
                    <div id="latest-txn" style="text-align:center; padding: 20px;">
                        <div class="score-gauge" id="score-gauge">
                            <div class="gauge-value">‚Äî</div>
                        </div>
                        <div id="latest-txn-details" style="margin-top: 16px; font-size: 0.82rem; color: var(--text-secondary);"></div>
                    </div>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <h3>üì° Transaction Stream</h3>
                    <button class="btn btn-primary" id="btn-stream" onclick="toggleStreaming()">‚ñ∂ Start Streaming</button>
                </div>
                <div class="live-feed" id="stream-feed" style="max-height: 320px;">
                    <div class="empty-state">
                        <div class="empty-icon">‚ö°</div>
                        <p>Click "Start Streaming" to begin real-time scoring</p>
                    </div>
                </div>
            </div>
        </div>

    </main>
</div>

<script src="/static/js/app.js"></script>
</body>
</html>
